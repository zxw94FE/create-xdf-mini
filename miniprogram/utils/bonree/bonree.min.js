/* eslint-disable */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t){return null!=t},e=function(t){return"function"==typeof t},n=function(t){return"string"==typeof t},i=function(e){return t(e)&&e instanceof Array},o=function(){},s=window||{},r=function(e){return t(e)&&!a(e)},a=function(e){if(t(e)){if(c(e,"length"))return!e.length;if(c(e,"size"))return!e.size;for(var n in e)if(c(e,n))return!1}return!0},c=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},u=function(e,n){if(t(e))for(var i in e){if(c(e,i))if(!1===n(e[i],i))break}},h=function(t,e){return i(t)?function(t,e){if(i(t))for(var n=0,o=t.length;n<o&&!1!==e(t[n],n);n++);}(t,e):u(t,e)},l=function(t,e){return t&&e&&u(e,(function(e,n){t[n]=e})),t},f="startTime",d="timestamp",p=t(s.JSON)?s.JSON.stringify:function(t){var e,n=typeof t;if("undefined"===n)return'"undefined"';if("boolean"===n)return t?"true":"false";if("number"===n)return t.toString();if("string"===n)return'"'+(e=t.replace(/(["\\])/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"))+'"';if("object"===n){if(!t)return"null";if(t instanceof Array)return e="[",h(t,(function(t,n){n>0&&(e+=","),e+=p(t)})),e+="]";e="{";var i=0;return u(t,(function(t,n){i>0&&(e+=","),e+=p(n)+":"+p(t),i++})),e+="}"}return"[none]"},g=!1,m=t(s.console)&&e(s.console.log)?s.console.log:o,v=t(s.console)&&e(s.console.error)?s.console.error:o,y=function(e,n){if(g){var i=e;t(n)&&(i+=": "+p(n)),m(i)}},w=function(e,n,i,o){if(t(e)||(e=function(){}),e.$$original)return e;var s=function(){var s,r=t((s=arguments).length)?Array.prototype.slice.call(s):s;if(!t(this))return e.apply(this,r);t(n)&&n.apply(this,r);try{return e.apply(this,r)}catch(e){t(o)?o.apply(this,r.concat(e)):function(t){v(t)}(e)}finally{t(i)&&i.apply(this,r)}};return s.$$original=e,s};l(function(t,e){this.lastTimer=null,this.lastEvent=null,this.period=e||1e3,this.compare=function(){return!1},this.submit=t||o}.prototype,{$schedule:function(e){t(this.lastTimer)&&clearTimeout(this.lastTimer);var n,i,o=this;this.lastEvent=e,this.lastTimer=(n=function(){o.submit(o.lastEvent),o.lastEvent=null},i=this.period,n.$$original=!0,setTimeout(n,t(i)?i:0))},event:function(e){t(this.lastEvent)&&(this.compare(this.lastEvent,e)?(e.info.duration=e.info[f]-this.lastEvent.info[f],e.info[d]=this.lastEvent.info[d],e.info[f]=this.lastEvent.info[f],e.info.count=this.lastEvent.info.count+1):this.submit(this.lastEvent)),this.$schedule(e)},flush:function(){t(this.lastTimer)&&(clearTimeout(this.lastTimer),this.lastTimer=null),t(this.lastEvent)&&(this.submit(this.lastEvent),this.lastEvent=null)},equalsWith:function(t){"apply"in t&&(this.compare=t)}}),l(function(){this.listeners={}}.prototype,{on:function(n,o){if(t(n)&&e(o)){var s=n;i(s)||(s=[n]),h(s,(r=function(e){var n=this.listeners[e];t(n)||(n=this.listeners[e]=[]),n.push(o)},a=this,function(){return r.apply(a,arguments)}))}var r,a},emit:function(e){if(t(e)&&t(e.t)){y(e);var n=e.t,i=this.listeners[n];h(i,(function(t){t(e)}))}}});var k=function(t,e){return!(!t||!t.indexOf)&&0===t.indexOf(e)},I=function(t,e){return!!(t&&e&&t.length>=e.length)&&t.substring(t.length-e.length)===e},b=function(t,e){return t?t.length<=e?t:t.substr(0,e-3)+"...":""};function S(){return Date.now?Date.now():(new Date).getTime()}var T=function(){var e=S();return function(n){var i;return t(s.performance)&&t(s.performance.now)&&t(s.performance.timing)?[i=0===n?0:Math.round(s.performance.now()),i+s.performance.timing.navigationStart]:[(i=0===n?e:S())-e,i]}}(),x=function(t){return T(t)[1]};function C(t){return t<0?NaN:t<=30?0|Math.random()*(1<<t):t<=53?(0|Math.random()*(1<<30))+(0|Math.random()*(1<<t-30))*(1<<30):NaN}function D(t,e){for(var n=t.toString(16),i=e-n.length,o="0";i>0;i>>>=1,o+=o)1&i&&(n=o+n);return n}function A(){return D(C(32),8)+"-"+D(C(16),4)+"-"+D(16384|C(12),4)+"-"+D(32768|C(14),4)+"-"+D(C(48),12)}var E,N="1.7.0",M="2023090201";const O=Symbol("$inner"),P="$$BR_CLIENTID",q=__wxConfig&&(null===(E=__wxConfig)||void 0===E||null===(E=E.accountInfo)||void 0===E?void 0:E.nickname)||"unkonw",$="conf",L="BonreeData",j="customlog",F="speedtest",U="customevent",R="custommetric",K="BONREE_APM_UID",J=["unknown","http1.1","h1s","h2","","ws","wss","tcp","","","udp","quic"],_="$$BR_LAUNCHID",H="sm4";function V(t){if(W(t))try{const e=JSON.parse(t);return!("object"!=typeof e||!e)}catch(t){return!1}else if("object"==typeof t)return!0;return!1}function W(t){return"[object String]"===Object.prototype.toString.call(t)}function z(t){return"number"==typeof t&&!isNaN(t)}const B=Object.assign;function Z(){return+new Date}function X(t){return"function"==typeof t}function G(t){return"object"==typeof t}function Q(t){let e=0;for(let n=0,i=t.length;n<i;n++){const i=t.charCodeAt(n);e+=i<=127?1:i<=2047?2:i<=65535?3:4}return e}function Y(t){if(!t)return 0;if("string"==typeof t){return Q(t)}if(t instanceof ArrayBuffer)return t.byteLength;if(G(t)){let e="";try{e=JSON.stringify(t)}catch(t){}return Q(e)}return 0}function tt(e){if(t(e))return Array.isArray(e)||e.length?e.length:0}function et(t){t=t||{};const e=[];for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==t[n]&&e.push(n+"="+nt(t[n],"msg"===n));return e.join("&")}function nt(t,e){try{t=e?encodeURIComponent(t).replace(/\(/g,"%28").replace(/\)/g,"%29"):encodeURIComponent(t)}catch(t){}return t}function it(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function ot(t){if(W(t))return t;let e="";try{e=JSON.stringify(t)}catch(t){}return e}var st=function(){return Date.now?Date.now():(new Date).getTime()},rt=function(){var t=st();return function(e){var n;return[1e3*((n=0===e?t:st())-t),1e3*n]}}(),at=function(t){return rt(t)[1]};function ct(e,n,o){if(!t(e)||!X(e[n]))return y("C03",n);const s=e[n];let r;r=i(o)?o:[],r.push(O);try{return s.apply(e,r)}catch(t){y("C04")}}function ut(t){if(t)return t.split(" ")[1]||"0"}function ht(t,e,n,i,o){return void 0!==t&&(null==e||""===e?(y(n+" Parameter has a value or key ["+t+"] that does not exist!"),!0):null!==i&&e.length>i?(y(n+" Parameter has a value or key ["+t+"] that the value length exceeds "+e.length+"!"),!0):!(!o||!isNaN(e))&&(y(n+" Parameter has a value or key ["+t+"] value is not a valid number!"),!0))}function lt(t,e){return t&&t.length>e?t.slice(0,e):t}
/* eslint-disable */
function ft(t){return t<0?NaN:t<=30?0|Math.random()*(1<<t):t<=53?(0|Math.random()*(1<<30))+(0|Math.random()*(1<<t-30))*(1<<30):NaN}
/* eslint-enable */function dt(t,e){for(var n=t.toString(16),i=e-n.length,o="0";i>0;i>>>=1,o+=o)1&i&&(n=o+n);return n}function pt(){return"00-"+dt(ft(32),8)+dt(ft(32),8)+dt(ft(32),8)+dt(ft(32),8)+"-"+dt(ft(32),8)+dt(ft(32),8)+"-00"}function gt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function mt(t){return 16==t?dt(ft(32),8)+dt(ft(32),8):32==t?dt(ft(32),8)+dt(ft(32),8)+dt(ft(32),8)+dt(ft(32),8):void 0}function vt(t){const e=/^(?:https?:\/\/)?(?:[^/@]+@)?(?:([^:/?#]+)|(?:\[(.*?)\]))/i.exec(t),n=/\?([^#]+)/i.exec(t);return{href:t,hostname:e&&e[1]||"",search:n&&n[1]||""}}const yt="mpview",wt="action",kt="launch",It="statechange",bt=Symbol("$hook");at();const St={confCount:5,beacon:{configAddress:"https://sdkupload.bonree.com/config"},appId:1,version:N,timeout:6e4};function Tt(t,n){if(!e(n))return t;const i=l({},t);return u(t,(function(t,o){e(t)&&(i[o]=n(t,o))})),i}function xt(n,i,o){const s=l({},n);return u(i,(function(i,r){s[r]=function(n,i,o,s){const r=t(n)&&e(n[i])?n[i]:function(){},a=t(s)&&e(s[i])?s[i]:function(){};return w(r,o,a)}(n,r,i,o)})),s}function Ct(t,e,n,i,o){return t[bt]?t:function(o){let s=Tt(o,i);return s=xt(s,e,n),t.$$origin=t,t.call(this,s)}}class Dt{constructor(){this.json={v:St.version,e:[]}}}function At(e){let n=ct(wx,"getStorageSync",[L]);t(n)&&""!=n?n.push(e):n=new Array(e),ct(wx,"setStorageSync",[L,n])}function Et(e){const n=ct(wx,"getStorageSync",[L]);if(ct(wx,"removeStorageSync",[L]),t(n)&&n.length>0){var i;const t=(null===(i=Rt.newConfig)||void 0===i?void 0:i.sat)||0;n.forEach((n=>{1e3*x()-n.mt<36e8*t&&e(n,!0)}))}}Dt.prototype.setNetworkStateInfo=function(t){return this.json.nsi=t,this},Dt.prototype.setMonitorTime=function(t){return this.json.mt=t,this},Dt.prototype.setConfigTime=function(t){return this.json.cmt=t,this},Dt.prototype.setSessionId=function(t){return this.json.s=t,this},Dt.prototype.setDeviceInfo=function(e){return t(e.di)||(e.di=(null==Ft?void 0:Ft.clientID)||""),this.json.di=e,this},Dt.prototype.setAppInfo=function(t){return this.json.ai=t,this},Dt.prototype.setFirstUserInfoIndex=function(){const e=Rt.userInfoFui;return t(e)&&(this.json.fui=e),this},Dt.prototype.setUserInfo=function(t,e){if("{}"===e)return this;const n=new Set;t.map((t=>{t.sin&&t.sin[0]&&n.add(t.sin[0])}));const i={};return n.forEach((t=>{i[t]=e[t]})),this.json.ui=i,this},Dt.prototype.setSessionDuration=function(t){return this.json.usd=t,this},Dt.prototype.pushEventData=function(t){const e={k:t.type,ent:t.ent,sin:t.sin,v:t.data};return this.json.e.push(e),this},Dt.prototype.build=function(t){return this.json};const Nt={smKey:"",identifier:""};function Mt(t){const e=Jt.use(H),n=Jt.getPluginCfg(H),i=n&&n.key,o=n&&n.identifier||"";if(Nt.identifier=o,e&&t&&n&&i&&o){let n;Nt.smKey=i;const o=JSON.stringify(t);try{return n=e(o,i,1),n||t}catch(e){return console.warn("encrypt data error!",e),t}return t}return t}function Ot(t,e){const n=Jt.use(H),i=Nt.smKey,o=e&&e.split(":")[1];if(n&&t&&i&&t instanceof ArrayBuffer&&o===Nt.identifier){let e;try{if(e=n(t,i,0),e){return JSON.parse(e)}}catch(t){console.warn("decrypt data error",t)}}}function Pt(){if(Jt.has(H)){const t=Jt.getPluginCfg(H),e=t&&t.identifier,n=t&&t.key;if(e&&n&&/^[A-Za-z0-9_-]{1,256}$/.test(e))return`sm4:${e}`}}function qt(){return!!Nt.smKey}function $t(e,n=!1){var i,o,s,r;if(Rt.stopAgent)return;if(e.length<=0)return;let a;if(n)a=e;else{var c=new Dt;c.setMonitorTime(1e3*Z()).setConfigTime(Rt.newConfig.st).setSessionId(Rt.newConfig.s).setDeviceInfo(Rt.deviceInfo).setAppInfo(Rt.appInfo).setUserInfo(e,Rt.userInfoMap).setNetworkStateInfo(Rt.networkStateInfoMap).setFirstUserInfoIndex();var u=0,h=0;e&&e.length>0&&e.forEach((function(t){const e=t.ent;(e<u||0===u)&&(u=e),(e>h||0===h)&&(h=e),c.pushEventData(t)}));var l=t(Rt.usdSt)&&h-Rt.usdSt||h-u;Rt.changUsdTime(h),c.setSessionDuration(l),a=c.build()}const f={brkey:A()},d=Pt();let p="";d&&(f["BR-Encryption-Method"]=d,f["Content-Type"]="application/octet-stream",p="arraybuffer",a=Mt(a));const g=null===(i=Rt.newConfig)||void 0===i?void 0:i.usc,m=Rt.networkStateInfo.ns;if(0!=g&&(1!=g||"wifi"!=m))return void At(a);const v={v:M,a:(null==Rt||null===(o=Rt.newConfig)||void 0===o?void 0:o.appId)||"",d:(null==Rt||null===(s=Rt.deviceInfo)||void 0===s?void 0:s.di)||"",mt:at(),cmt:Rt.newConfig.st,s:Rt.newConfig.s};let y=null==Rt||null===(r=Rt.newConfig)||void 0===r?void 0:r.ua;y="".concat(y,"?",et(v)),wx.request({url:y,data:a,method:"POST",header:f,timeout:St.timeout,responseType:p,ignore:!0,success(t){if(t&&t.statusCode<400){let e=t.data;const n=t.header&&t.header["BR-Encryption-Method"]||t.header&&t.header["br-encryption-method"];qt()&&n&&(e=Ot(t.data,n)),e&&1e4===e.rc?Et($t):At(a)}else At(a)},fail(){At(a)},complete(){Rt.cleanFuidata()}})}const Lt=new class{constructor(){this.dataArr=[],this.setLen=10,this.setSize=10240,this.setTime=15e3,this.timer="",this.json={v:N,e:[]},this.close=!1,this.needCheckData=!1,this.clearDataArr=[]}dataArrAddFun(t,e=!1){""===t.sin[2]&&(this.needCheckData=!0);const n=tt(this.dataArr),i=Y(this.dataArr);return n<this.setLen&&i<this.setSize&&this.dataArr.push(t),e?(this.uploadData(),clearTimeout(this.timer)):this.checkData(),this}checkDataFun(t){this.needCheckData&&(this.dataArr.map((e=>{e.sin[2]=t})),this.needCheckData=!1)}clearCacheData(t){this.clearDataArr=t}checkData(){clearTimeout(this.timer);const t=tt(this.dataArr),e=Y(this.dataArr);if(t>=this.setLen||e>=this.setSize)this.uploadData();else{const t=this;this.timer=setTimeout((function(){t.uploadData()}),this.setTime)}return this}uploadData(){var t;if(this.close)this.claerData();else if(null!=Rt&&null!==(t=Rt.newConfig)&&void 0!==t&&t.newSetConfig&&this.dataArr.length>0){$t(this.dataArr.filter((t=>!this.clearDataArr.includes(t.type)))),this.claerData()}}claerData(){this.dataArr=[]}stopDataCatch(){this.close=!0}updateTime(t){t&&t>0&&(this.setTime=1e3*t)}};function jt(t){this.networkType="",this.system={type:1,brand:t&&t.brand,model:t&&t.model,pixelRatio:t&&t.pixelRatio,screenWidth:t&&t.screenWidth,screenHeight:t&&t.screenHeight,version:t&&t.version,system:t&&t.system,platform:t&&t.platform,SDKVersion:t&&t.SDKVersion,language:t&&t.language},this.appInfo=null,this.clientID=null,this.page=null,this.route=[],this.sid=it(),this.uid="",this.requests=[],this.firstLaunch=null,this.pvidDatas={},this.pageModel=0,this.pageTimeId=0}jt.prototype.getFirstLaunchDataFun=function(){return t(this.firstLaunch)||(this.firstLaunch=ct(wx,"getStorageSync",[_])),this.firstLaunch},jt.prototype.setFirstLaunchDataFun=function(){const t=A();return ct(wx,"setStorageSync",[_,t]),t},jt.prototype.popReqs=function(){const t=B([],this.requests);return this.requests=[],t},jt.prototype.popRoute=function(){const t=B([],this.route);return this.route=[],t},jt.prototype.popPage=function(t=!1){const e=this.page;return t||(this.page=null),e},jt.prototype.i=function(e,n){if(!t(n))return this[e];this[e]=n},jt.prototype.getClientID=function(){return t(this.clientID)||(this.clientID=ct(wx,"getStorageSync",[P]),this.clientID||(this.clientID=this.setClientID())),this.clientID},jt.prototype.setClientID=function(){const t=A();return ct(wx,"setStorageSync",[P,t]),t},jt.prototype.initUidFun=function(){let t=ct(wx,"getStorageSync",[K]);return t||(t=it(),t&&ct(wx,"setStorageSync",[K,t])),this.uid=t,this.uid},jt.prototype.getAppInfo=function(){const t=ct(wx,"getAccountInfoSync");if(null!=t&&t.miniProgram){const e=t.miniProgram;""===e.version&&(e.version="1.0.0"),this.appInfo=t.miniProgram}return this.appInfo};const Ft=new jt(wx.getSystemInfoSync());function Ut(){var t,e;const n=A();var i;this.appHideTime=null,this.pageHideTime=null,this.deviceInfo={di:Ft.getClientID(),a:"user",bn:Ft.system&&Ft.system.brand,m:Ft.system&&Ft.system.model,omv:Ft.system&&Ft.system.system&&ut(Ft.system.system),ot:Ft.system&&Ft.system.system&&(i=Ft.system.system,i&&"string"==typeof i?i.toLowerCase().indexOf("ios")>-1?0:i.toLowerCase().indexOf("android")>-1?1:i.toLowerCase().indexOf("windows")>-1?2:i.toLowerCase().indexOf("harmonyos")>-1?3:4:4),l:Ft.system&&Ft.system.language,ds:Ft.system&&`${Ft.system.screenWidth}X${Ft.system.screenHeight}`,ram:-1,rom:-1,ctn:"WeChat",ctv:Ft.system&&Ft.system.version},this.appInfo={ai:(null==Ft||null===(t=Ft.appInfo)||void 0===t?void 0:t.appId)||"",av:(null==Ft||null===(e=Ft.appInfo)||void 0===e?void 0:e.version)||"1.0.0",an:q,ci:"",at:5},this.userInfo={ui:null,ei:null},this.userInfoMap={},this.userInfoKey=null,this.userInfoFui=null,this.networkStateInfo={dip:"",ns:""},this.networkStateInfoMap={},this.networkStateInfoKey=null,this.newConfig=St,this.channel=null,this.max_256=256,this.MAX_64=64,this.usdSt=null,this.stopAgent=!1,this.deviceStateInfoKey=n,this.launchTime=null,this.customPageUid=[],this.customEventUid=[],this.unableConfig=!1}Ft.getAppInfo(),Ut.prototype.closeConfig=function(){this.unableConfig=!0},Ut.prototype.setCustomPageUidFun=function(t){this.customPageUid=[...this.customPageUid,t]},Ut.prototype.setCustomEventUidFun=function(t){this.customEventUid=[...this.customEventUid,t]},Ut.prototype.getCustomPageUidFun=function(t){const e=[...this.customPageUid];let n=null;return e.map(((i,o)=>{i.name===t&&(n=i,e.splice(o,1))})),this.customPageUid=[...e],n},Ut.prototype.getCustomEventUidFun=function(t){const e=[...this.customEventUid];let n=null;return e.map(((i,o)=>{i.id===t&&(n=i,e.splice(o,1))})),this.customEventUid=[...e],n},Ut.prototype.setLaunchTime=function(e){e&&t(e)&&(this.launchTime=e)},Ut.prototype.cleanFuidata=function(){this.userInfoFui=null},Ut.prototype.closeAgent=function(t){t&&(this.stopAgent=t)},Ut.prototype.checkUserInfoMapForKey=function(e=!1){if(!t(this.userInfo.ui))return void(this.userInfoKey=null);const n={ui:this.userInfo.ui};t(this.userInfo.ei)&&(n.ei=this.userInfo.ei);let i=!1;const o=this,s=l({},this.userInfoMap);if(Object.keys(s).length>0){Object.entries(s).forEach((function(t){JSON.stringify(t[1])===JSON.stringify(n)&&(o.userInfoKey=t[0],i=!0)}))}if(!i){const t=A();this.userInfoKey=t,this.userInfoFui=t,this.userInfoMap[t]=l({},n)}},Ut.prototype.changUsdTime=function(e){t(e)&&(this.usdSt=e)},Ut.prototype.setExtraInfo=function(e){t(e)&&""!==e&&"{}"!==e&&(e&&G(e)&&JSON.stringify(e).length>7e3||this.userInfo.ui&&(this.userInfo.ei=JSON.stringify(e),this.checkUserInfoMapForKey(!0)))},Ut.prototype.setDeviceId=function(t){ht("deviceID",t,"setDeviceID",this.max_256,!1)||/^[a-zA-Z0-9_-]+$/.test(t)&&(this.deviceInfo.di=t)},Ut.prototype.setChannelId=function(e){ht("channelId",e,"setChannelId",this.max_256,!1)||(t(e)&&"string"==typeof e?this.appInfo.ci=e:y("setChannelId error!"))},Ut.prototype.setAppVersion=function(e){t(e)&&"string"==typeof e&&tt(e)<=this.MAX_64?this.appInfo.av=e:y("setAppVersion error!")},Ut.prototype.setUserInfo=function(t){if(""!==t){if(ht("userId",t,"setUserID",this.max_256,!1))return;if(!/^[:a-zA-Z0-9_-]+$/.test(t))return;this.userInfo={...this.userInfo,ui:t}}else this.userInfo={ui:null,ei:null};this.checkUserInfoMapForKey()},Ut.prototype.setAppHideTime=function(e){return t(e)?this.appHideTime=e:this.appHideTime=x(),this},Ut.prototype.setPageHideTime=function(e){return t(e)?this.pageHideTime=e:this.pageHideTime=x(),this},Ut.prototype.getNetworkInfoFun=function(){const t=this;return wx.getNetworkType({success(e){t.networkStateInfo.ns=e.networkType,""!=t.networkStateInfo.ns&&""!=t.networkStateInfo.dip&&t.checkNetWorkInfoMapForKey()}})},Ut.prototype.setNetworkInfoIP=function(e){t(e)&&(this.networkStateInfo.dip=e,""!=this.networkStateInfo.ns&&""!=this.networkStateInfo.dip&&this.checkNetWorkInfoMapForKey())},Ut.prototype.checkNetWorkInfoMapForKey=function(){const t=this;let e=!1;const n=l({},this.networkStateInfoMap);if(Object.keys(n).length>0){Object.entries(n).forEach((function(n){JSON.stringify(n[1])===JSON.stringify(t.networkStateInfo)&&(t.networkStateInfoKey=n[0],e=!0)}))}if(!e){const e=A();t.networkStateInfoKey=e,t.networkStateInfoMap[e]=l({},t.networkStateInfo),Lt.checkDataFun(e)}},Ut.prototype.setNewConfig=function(e){if(t(e)){this.newConfig=l({initTime:x()},e),e.di&&this.setNetworkInfoIP(e.di),e.rct&&Lt.updateTime(e.rct);const n=ct(wx,"getStorageSync",[$]);let i={};t(n)&&(i={...n,...this.newConfig}),ct(wx,"setStorageSync",[$,i])}return this.newConfig},Ut.prototype.initSession=function(e){var n;const i="br-session"+((null===(n=this.newConfig)||void 0===n?void 0:n.appId)||"appId"),o=t(e)?e:x(),s=[(null==Ft?void 0:Ft.sid)||"",o,o,1],r=s.join("|");return ct(wx,"setStorageSync",[i,r]),{e:s,s:0,init:!0}},Ut.prototype.getSessionInfo=function(){var e,n,i,o;const s="br-session"+((null===(e=this.newConfig)||void 0===e?void 0:e.appId)||"appId"),r=x(),a=ct(wx,"getStorageSync",[s]);if(!t(a))return this.initSession(r);const c=a.split("|"),u=c[0],h=parseInt(c[1]),l=parseInt(c[2]),f=parseInt(c[3]),d=(null===(n=this.newConfig)||void 0===n?void 0:n.sessionEvents)||0,p=(null===(i=this.newConfig)||void 0===i?void 0:i.sessionPeriod)||0,g=(null===(o=this.newConfig)||void 0===o?void 0:o.sessionTimeout)||0;let m=f<d;if(m=m&&!isNaN(h)&&r-h<=p,m=m&&!isNaN(l)&&r-l<g,m){const t=[u,h,r,f+1],e=t.join("|");return ct(wx,"setStorageSync",[s,e]),{e:t,s:Math.max(r-l,0),init:!1}}return this.initSession(r)};var Rt=new Ut;function Kt(t,e,n){this.ci=it().concat("-",Z()),this.networkType="",this.url=t.path,this.param=t.param,this.pvid=t.path?Ft.pvidDatas[t.path]:null,this.pre="",this.loadTs=null,this.showTs=null,this.showEndTs=null,this.readyTs=null,this.hideTs=null,this.unloadTs=null,this.loadEndTs=null,this.uploadTs=null,this.sys=n,this.statesInfo=[]}Rt.getNetworkInfoFun(),Kt.prototype.toJson=function(){const t={};this.loadTs&&(t.onLoad=1e3*this.loadTs),this.showTs&&(t.onShow=1e3*this.showTs),this.readyTs&&(t.onReady=1e3*this.readyTs),this.hideTs&&(t.onHide=1e3*this.hideTs),this.unloadTs&&(t.onUnload=1e3*this.unloadTs);let e,n=999,o="",s=0;this.readyTs&&this.loadTs&&(n=t.onReady-t.onLoad),this.uploadTs&&this.showTs&&4===Ft.pageModel?o=1e3*(this.uploadTs-this.showTs):this.hideTs&&this.showTs?o=1e3*(this.hideTs-this.showTs):this.unloadTs&&this.showTs&&(o=1e3*(this.unloadTs-this.showTs)),this.loadTs&&this.loadEndTs?s=this.loadEndTs-t.onLoad:this.showTs&&this.showEndTs&&(s=1e3*(this.showEndTs-this.showTs)),i(this.statesInfo)?(e=JSON.parse(JSON.stringify(this.statesInfo)),e=e.length>0?e:""):e=this.statesInfo;const r=function(t){var e;const n=null==Rt||null===(e=Rt.newConfig)||void 0===e?void 0:e.mc;let i=0;if(n&&n.length>0)for(let e=0,o=n.length-1;e<=o;e++)if(n[e].n===t){i=n[e].tv;break}return 1e3*i}("mpview"),a={ci:this.ci,pvid:this.pvid,url:this.url,wpi:t,routes:B([],this.routes),param:"{}"==ot(this.param)?"":ot(this.param),rt:n,lt:s,std:e,is:n>r};return 0!=o&&(a.st=o),a};const Jt=new class{constructor(){this.plugin={},this.registedPlugin=new Set,this.pluginCfg={}}register(t,n,i){t&&e(n)&&(this.plugin[t]=n,this.pluginCfg[t]=i,this.registedPlugin.add(t))}install(t,e){if(t&&G(t)){const n=t.name,i=t.exec;if(this.registedPlugin.has(n))return;this.register(n,i,e)}}use(t){return this.plugin[t]}has(t){return this.registedPlugin.has(t)}getPluginCfg(t){return this.pluginCfg[t]}};class _t{constructor(t,e){this.d_type=e,this.data=t||{},this.$metric={},this.ent=t&&t.info&&t.info.timestamp&&t.info.timestamp||at()}info(e,n="",i,o=!1){const s=this.data;if(!t(s))return this;let r=s[e];return t(r)||(r=n),t(i)&&(e=i),o&&""===r||(this.$metric[e]=r),this}setMetricData(t,e){t&&e&&(this.$metric[t]=e)}getMetricData(t){return this.$metric[t]||""}metric(e,n="",i){const o=this.data;if(!t(o))return this;let s=o[e];return t(s)||(s=t(n)?n:-1),t(i)&&(e=i),this.$metric[e]=s,this}build(t){const e={type:this.d_type,ent:t||this.ent,data:{},sin:[Rt.userInfoKey||"","",Rt.networkStateInfoKey||""]},n=this.$metric;return e.data=n,e}}let Ht=!1;function Vt(e){Ht=!1;const n=new _t(e,kt);let i,o;const s=Ft.getFirstLaunchDataFun();t(s)&&""!==s?i=1:(i=3,Ft.setFirstLaunchDataFun()),o=Rt.launchTime||999;const r=function(t){var e;const n=null==Rt||null===(e=Rt.newConfig)||void 0===e?void 0:e.mc;let i=0;if(n&&n.length>0)for(let e=0,o=n.length-1;e<=o;e++)if(n[e].n===t){i=n[e].tv;break}return 1e3*i}("coollaunch"),a=o>r;n.info("t",i).info("lt",o).info("is",a);const c=n.build();Lt.dataArrAddFun(c)}class Wt{constructor(){this.currentActionId="",this.actionDatas=new Map,this.currentPage="",this.currentParentNode={},this.isStart=!1,this.actionAnalyse=!1,this.collectionProbability=30,this.maxDepth=5,this.operationTimeout=3e4,this.hasMpView=!1,this.hasNetWork=!1}static getInstance(){return Wt.instance||(Wt.instance=new Wt),Wt.instance}actionConfig(t){const{ac:e=!1,cp:n=30,mmd:i=5,aot:o=3e4}={...t};this.actionAnalyse=e,this.collectionProbability=n,this.maxDepth=i,this.operationTimeout=o}setActionData(t,e){this.actionDatas.set(t,e)}actionStart(t,e,n,i,o,s){const r=A();let a;if(s&&G(s)){const{c_type:t,text:e,fnName:n,tag:i}={...s};a=new Gt(n),a.create(t,e,i)}const c=new Zt(t,r,i,e,n,o,a),u=c.createMethod(e,12,o,null,"root",r);return this.currentActionId=r,this.currentPage=t,this.setActionData(r,c),{actionId:r,method:u}}checkReqEnd(t,e){return this.actionDatas.get(t).reqMethod.every(((t,e)=>t.reqState))}actionEnd(t,e,n,i){const o=this.actionDatas.get(t);if(G(o))if(o.mode=e,1===e&&t)o.loadTime||(o.endTime=1e3*x(),o.loadTime=o.endTime-o.startTime),Te(o,e),!1!==this.actionAnalyse&&!1!==o.thisActionAnalyse||this.actionDatas.delete(t);else if(12===n&&3===e)Te(o,1),o.ice=!0,Te(o,2),clearTimeout(o.operationTimeoutId),this.actionDatas.delete(t);else if(3===n&&2===e)o.reqMethod.forEach((t=>{t&&!1===t.reqState&&""===t.et&&(t.et=1e3*x())})),Te(o,e),clearTimeout(o.operationTimeoutId),this.actionDatas.delete(t);else if(1===n&&this.checkReqEnd(t,i))Te(o,e),clearTimeout(o.operationTimeoutId),this.actionDatas.delete(t);else if(12===n&&2===e)Te(o,e),clearTimeout(o.operationTimeoutId),this.actionDatas.delete(t);else if(1===n&&!1===this.checkReqEnd(t,i)){const n=this.operationTimeout-5e3>0?this.operationTimeout:5e3,i=this;if(0===o.operationTimeoutId){const s=setTimeout((function(){o.reqMethod.forEach((t=>{t&&!1===t.reqState&&(t.to=!0,t.et=1e3*x())})),Te(o,e),clearTimeout(o.operationTimeoutId),i.actionDatas.delete(t)}),n);o.operationTimeoutId=s}}}actionEnd_Hide(t,e){if(0!==this.actionDatas.size||!1!==this.actionAnalyse)return-1===e&&this.actionDatas.size>0?(this.actionDatas.forEach((e=>{e.mode=t,clearTimeout(e.operationTimeoutId),Te(e,t)})),void this.actionDatas.clear()):void 0}}const zt=new Wt;function Bt(t,e){if(zt.isStart=!0,t&&t.ac?zt.actionConfig(t.ac):zt.actionAnalyse=!1,e&&i(e)){const t=JSON.stringify(e);t.indexOf("network")>0?zt.hasNetWork=!0:zt.hasNetWork=!1,t.indexOf("mpview")>0?zt.hasMpView=!0:zt.hasMpView=!1}}class Zt{constructor(t,e,n,i,o,s,r){this.id=e,this.ti=ft(16),this.mode=1,this.type=n,this.sourceAction=3,this.ci=r,this.info=i,this.name=o,this.viewName=t,this.ic=!1,this.ice=!1,this.param="",this.loadTime="",this.startTime=1e3*s,this.endTime="",this.is=!1,this.currentMethod=[],this.method=[],this.me=[],this.reqMethod=[],this.reqEndTime=0,this.hasReq=!1,this.reqTimeId=0,this.thisActionAnalyse=!1,this.operationTimeoutId=0,this.methodNumber=0,this.aboverMaxDepth=!1,this.aboverMaxNumber=!1}isStartactionAnalyse(){const t=zt.actionAnalyse,e=zt.collectionProbability,n=Math.floor(100*Math.random());return this.thisActionAnalyse=!!(t&&e&&e>n)&&t,this.thisActionAnalyse}createMethod(t,e,n,i,o,s,r){this.limit("start",200);const a=new Xt(t,e,n,i,o,s,r,this.ti);return this.currentMethod.push(a),this.method.push(a),a}createReqMethod(e,n,i,o,s,r,a){this.limit("start",200);const c=new Xt(e,n,i,o,s,r,a,this.ti);if(t(o)||r||console.warn('"id or rootId" can not be undefined '),1===n&&(this.reqMethod.push(c),this.currentMethod.push(c)),2===n)return this.reqMethod.push(c),c}getParentId(){if(i(this.currentMethod)&&this.currentMethod.length>=1)return this.currentMethod[this.currentMethod.length-1].id}updateParentNode(t,e,n,i){(t||e||n)&&(!1===i&&this.method.forEach((i=>{(i&&i.parentId===t||i.id===t)&&(i[e]=n),i&&"root"===i.parentId&&""===i.et&&"et"===e&&(i.et=n)})),i&&this.reqMethod.forEach((i=>{i&&i.id===t&&(i[e]=n)})))}getParentNode(){if(i(this.currentMethod)&&this.currentMethod.length>=1)return this.currentMethod[this.currentMethod.length-1]}methodEnd(t){const e=this.currentMethod.pop();e&&(e.methodFinish(t),this.limit("end",200))}limit(t,e){"start"===t&&this.methodNumber++;const n=this.method.length+2*this.reqMethod.length;this.currentMethod.length+1>=zt.maxDepth?this.aboverMaxDepth=!0:this.aboverMaxDepth=!1,this.aboverMaxNumber=n>=e}limitNodeNumber(t){if(this.method.length+this.reqMethod.length>=50&&t){let e=0;return this.method.concat(this.reqMethod).forEach((n=>{n&&n.parentId===t&&e++})),e>=50}}reqEnd(t,e,n){const i=x();if(1!==t)2===t&&(this.reqEndTime=1e3*i,this.reqMethod.forEach((t=>{t&&t.id===e&&""===t.et&&(t.et=1e3*i,t.reqState=!0),t&&n&&t.id===n&&(t.reqState=!0)})),this.limit("end",200));else{const t=this.currentMethod.pop();t&&(t.methodFinish(i),this.limit("end",200))}}}class Xt{constructor(t,e,n,i,o,s,r=!1,a){this.id=i||A(),this.parentId=o,this.rootId=s,this.reqState=!1,this.n=t,this.t=e,this.to=!1,this.ice=r,this.st=1e3*n,this.et="",this.im=!0,this.ti=a,this.ne=""}methodFinish(t){this.et||(this.et=1e3*t)}}class Gt{constructor(t){this.f=t}create(t,e,n){t&&(this.td=t),n&&(this.tag=n)}}function Qt(t,e){return function(n){if(!zt.isStart)return t.apply(this,arguments);if(n&&n.target&&n.currentTarget){const i=zt.actionAnalyse;let o=!1;const s=n&&n.currentTarget.dataset||{},r=n.currentTarget.id,a=n&&n.currentTarget.dataset||{};G(a)&&r&&(a.id=r);const c=x();let u;const h=n&&n.type;if(n&&"tap"===n.type)u=1;else{if(!n||"input"!==n.type)return t.apply(this,arguments);u=4}const l={c_type:h,text:s&&"{}"!==JSON.stringify(s)?JSON.stringify(s):"unknow",fnName:e},f=`${n.type} ${JSON.stringify(a)}`,d=this.route?this.route:this.is,{actionId:p,method:g}=zt.actionStart(d,e,f,u,c,l),m=zt.actionDatas.get(p);o=m.isStartactionAnalyse(),zt.currentParentNode=g||{};try{return t.apply(this,arguments)}catch(t){throw y("C401"),t}finally{m.methodEnd(x()),zt.currentParentNode={},zt.actionEnd(p,1,12),(!1===m.hasReq&&i&&o||!1===zt.hasNetWork&&i&&o)&&zt.actionEnd(p,2,12)}}else{if(!zt.actionAnalyse)return t.apply(this,arguments);if(["onLaunch","onShow","onHide","onError","onPageNotFount","onThemeChange","onUnhandledRejection","onUnhandleRejection","onReady","onLoad","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onShareTimeline","onAddToFavorites","onPageScroll","onResize","onTabItemTap","onSaveExitState","created","attached","ready","moved","detached","error","show","hide","resize"].indexOf(e)>=0)return t.apply(this,arguments);let n,i=zt.currentActionId;const o=zt.currentParentNode;if(o&&o.rootId!==i&&(i=o.rootId),n=zt.actionDatas.get(i),!n)return t.apply(this,arguments);const s=x(),r=n.getParentId(),a=n.ice,c=n.aboverMaxDepth,u=n.aboverMaxNumber,h=n.limitNodeNumber(r),l=n.thisActionAnalyse;if(n&&!0===n.hasReq&&n.reqEndTime>0&&n.reqEndTime<1e3*s)return t.apply(this,arguments);if(!0===a||c||u||h||!1===l)return t.apply(this,arguments);const f=n.getParentNode(),d=n.createMethod(e,13,s,null,r,i);zt.currentParentNode=d;try{return t.apply(this,arguments)}catch(t){throw t}finally{zt.currentParentNode=f,n.methodEnd(x())}}}}function Yt(){if(!Ft.page)return void y("page should been created when load");ie(Ft.popPage(!0).toJson(),1)}function te(){if(!Ft.page)return void y("page should been created when OnShow");Ft.page.uploadTs=Z();ie(Ft.popPage(!0).toJson())}function ee(t,e){if(!Ft.page)return void y("page should been created when unload");Ft.page[t]=e.t;ie(Ft.popPage().toJson(),2)}function ne(n="page"){t(this.setUpdatePerformanceListener)&&e(this.setUpdatePerformanceListener)?this.setUpdatePerformanceListener({withDataPaths:!0},(e=>{if(!t(Ft.page))return void y("'page' dose not been created ");const{updateStartTimestamp:o,updateEndTimestamp:s,pendingStartTimestamp:r,dataPaths:a}=e;if(!i(a))return;const c=Y(a.map((t=>{if(t.length>1){let e="",{data:n}=this;for(const i of t)e+=z(i)?`[${i}]`:`.${i}`,n=n[i];return{[e.substring(1)]:n}}return{[t]:this.data[t]}}))),u={ust:1e3*o,uet:1e3*s,pst:1e3*r,d:a.reduce((function(t,e){return t.concat(e)})),s:c,p:"page"===n?this.route:this.is};Ft.page.statesInfo[Ft.page.statesInfo.length]=u,4===Ft.pageModel&&(1===Ft.page.statesInfo.length&&(Ft.pageTimeId=setTimeout((()=>{te(),t(Ft.page)&&(Ft.page.statesInfo=[]),clearTimeout(Ft.pageTimeId)}),15e3)),Ft.page.statesInfo.length>=10&&(te(),t(Ft.page)&&(Ft.page.statesInfo=[]),clearTimeout(Ft.pageTimeId)))})):y("This version is not compatible 'setUpdatePerformanceListener' method")}function ie(e,n){if(!1===zt.hasMpView)return;const i=new _t(e,yt);i.info("ci").info("pvid").info("url","","n").info("ic",!1).info("m",Ft.pageModel).info("param","","p",!0).info("rt").info("st",0,"st").info("lt").info("std","","std",!0),1===n?i.info("is",!1):i.info("",!1,"is"),t(e.param)&&"{}"!=e.param&&""!=e.param&&i.info("param","","p");const o=i.build();Lt.dataArrAddFun(o)}const oe=new class{constructor(){this.url="",this.networkData={},this.originUrl="",this.urlObj={}}checkSensitive(t,e){if(!e)return;if(e&&0===e.length)return;const n=t.url||"";if(!function(t){return/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/i.test(t)}(n))return;this.url=n,this.networkData=t,this.originUrl=n,this.urlObj=vt(n);(this.urlObj.search||t.rh||t.rhe)&&this.startMatch(e)}startMatch(t){for(let e=0;e<t.length;e++){const n=t[e];n&&n.sa&&n.t&&(this.url=this.networkData.url,this.urlObj=vt(this.url),2===n.t?this.andLogic(n.sa,this.originUrl)&&this.desensitize(n):this.orLogic(n.sa,this.originUrl)&&this.desensitize(n))}this.clear()}andLogic(t,e){return t.every((t=>this.matchURL(e,t.t,t.r,t.c)))}orLogic(t,e){return t.some((t=>this.matchURL(e,t.t,t.r,t.c)))}matchURL(t,e,n,i){const o=this.urlObj&&this.urlObj.hostname||"",s=1===e?o.toLowerCase():t;switch(i=1===e?i.toString().toLowerCase():i,n){case 1:if(s==i)return!0;break;case 2:if(s.indexOf(i)>-1)return!0;break;case 3:if(k(s,i))return!0;break;case 4:if(I(s,i))return!0}return!1}desensitize(e){const n=e.mt,i=e.mk;this.urlObj&&this.urlObj.search&&t(i.aqk)&&this.delorVagueKey(n,i.aqk,"qka",i.qka),this.networkData.rh&&t(i.areqh)&&this.delorVagueKey(n,i.areqh,"reqhka",i.reqhka),this.networkData.rhe&&t(i.aresh)&&this.delorVagueKey(n,i.aresh,"reshka",i.reshka)}delorVagueKey(t,e,n,i){if(n)if("qka"!==n&&(i=this.toLowerCase(i)),!0===e)"qka"===n?1===t?this.networkData.url=this.networkData.url.split("?")[0]:this.VagueAllKey(0,n,i,this.networkData.url):"reqhka"===n?1===t?(this.networkData.rh="",this.networkData.reqht=""):this.VagueAllKey(1,n,i,this.networkData.rh,this.networkData.reqht):"reshka"===n&&(1===t?(this.networkData.rhe="",this.networkData.resht="",this.networkData.tid="",this.networkData.xbr="",this.networkData.trsp=""):(this.VagueAllKey(2,n,i,this.networkData.rhe,this.networkData.resht),this.networkData.tid="**",this.networkData.xbr="**",this.networkData.trsp="**"));else if(!1===e&&i&&i.length>0)if("qka"===n)for(let e=0;e<i.length;e++){const n=i[e],o=new RegExp(`${n}=([^&]+)`);if(o instanceof RegExp&&o.test(this.networkData.url)){let e=1===t?this.networkData.url.replace(o,""):this.networkData.url.replace(o,`${n}=**`);1===t&&e.endsWith("?")&&(e=e.replace("?","")),1===t&&e.includes("?&")&&(e=e.replace("?&","?")),this.networkData.url=e}}else if("reqhka"===n){const e=this.networkData.rh&&V(this.networkData.rh)&&JSON.parse(this.networkData.rh),n=this.networkData.reqht;if(e){const n=this.traverseObject(e,i,t,!1);this.networkData.rh=JSON.stringify(n)}n&&G(n)&&(this.networkData.reqht=this.traverseObject(n,i,t,!1))}else if("reshka"===n){const e=this.networkData.rhe&&V(this.networkData.rhe)&&JSON.parse(this.networkData.rhe),n=this.networkData.resht;if(e){const n=this.traverseObject(e,i,t,!1);this.networkData.rhe=JSON.stringify(n)}n&&G(n)&&(this.networkData.resht=this.traverseObject(n,i,t,!1)),this.networkData.tid&&i&&i.indexOf("br-resp-key")>-1&&(this.networkData.tid=1===t?"":"**"),this.networkData.xbr&&i&&i.indexOf("x-br-response")>-1&&(this.networkData.xbr=1===t?"":"**"),this.networkData.trsp&&i&&i.indexOf("traceresponse")>-1&&(this.networkData.trsp=1===t?"":"**")}}VagueAllKey(t,e,n,i,o){if(e&&i)if("qka"===e){const t=this.url.replace(/(\?|&)([^=&]+)=([^&]+)/g,"$1$2=**");this.networkData.url=t}else{if(i&&V(i)){const e=JSON.parse(i),o=this.traverseObject(e,n,2,!0);1===t?this.networkData.rh=JSON.stringify(o):2===t&&(this.networkData.rhe=JSON.stringify(o))}if(o&&G(o)){const e=this.traverseObject(o,n,2,!0);1===t?this.networkData.reqht=e:2===t&&(this.networkData.resht=e)}}}traverseObject(t,e,n,i){if(t&&e&&!1===i){const i=e.toString();for(const e in t)if(Object.hasOwnProperty.call(t,e)){const o=new RegExp(`${e}`,"i");o instanceof RegExp&&o.test(i)&&(1===n?delete t[e]:t[e]="**")}}else if(t&&!0===i&&2===n)for(const e in t)Object.hasOwnProperty.call(t,e)&&(t[e]="**");return t}toLowerCase(t){if(t&&t.length>0)return t.map((t=>t&&t.toString().toLowerCase()))}clear(){this.url="",this.networkData={},this.urlObj={},this.originUrl=""}};function se(e){if(t(Rt.newConfig.cbbk)&&Rt.newConfig.cbbk.length>0){let i="";if(V(e.body))try{let n="";n="object"==typeof e.body?e.body:new Function("","return "+e.body)(),h(Rt.newConfig.cbbk,(function(e,o){t(n[e])&&(i+=`${e}=${encodeURIComponent(n[e])}&`)})),e.cbbq=i.slice(0,-1)}catch(t){}else if(n(e.body))try{const t=e.body.split("&");h(t,(function(t){h(Rt.newConfig.cbbk,(function(e,n){const o=e+"=";e&&-1!==t.indexOf(o)&&(i+=t+"&")}))})),e.cbbq=i.slice(0,-1)}catch(t){}}if(t(Rt.newConfig.cbqk)&&n(e.url))try{let t="",n=e.url.split("?")[1];n&&(n=n.split("&")),h(n,(function(e){h(Rt.newConfig.cbqk,(function(n,i){const o=n+"=";n&&-1!==e.indexOf(o)&&(t+=e+"&")}))})),e.cbq=t.slice(0,-1)}catch(t){}if(t(Rt.newConfig.cbhk)&&t(e.rh))try{const t=Rt.newConfig.cbhk;let n="";const i=V(e.rh)&&JSON.parse(e.rh)||[],o=Object.keys(i);for(let e=0,s=o.length-1;e<=s;e++){const s=o[e];t.includes(s)&&(n+=s+"="+i[s]+"&")}e.cbhq=n.slice(0,-1)}catch(t){}return e}function re(e,n){var i,o;Rt.newConfig&&Rt.newConfig.snr&&oe.checkSensitive(n,Rt.newConfig.snr),se.call(this,n);let s=0;const r=null==n?void 0:n.url;try{s=J.indexOf(n.pt),-1===s&&(s=0)}catch(t){}if(0===s&&(/^https/.test(r)?s=2:/^http/.test(r)&&(s=1)),/(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])/.test(r)){const e=function(t){if(t)return/(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\:([0-9]{1,5})/.test(t)?[`${RegExp.$1}.${RegExp.$2}.${RegExp.$3}.${RegExp.$4}`,Number(RegExp.$5)]:/\:([0-9]{1,5})/.test(t)?["",Number(RegExp.$1)]:t.indexOf("https")>-1?["",443]:["",80];return["",""]}(r);t(n.ti)&&""!==n.ti||(n.ti=e[0]),t(n.tp)&&""!==n.tp||(n.tp=e[1])}n.pt=s;const a=new _t(n,"network");a.info("url","","ru").info("method","","m").info("ec",200).info("dti",0,"dti").info("rt",0,"rt").info("rti",0,"rti").info("ds").info("rds","","rds").info("tid","","tid",!0).info("ti","").info("tp",443).info("dt",0).info("ct",0).info("sslt",0).info("pt",s).info("em","","em",!0).info("art",3).info("ic",!1).info("cbhq","","cbhq",!0).info("cbbq","","cbbq",!0).info("cbq","","cbq",!0).info("rei","","rei",!0).info("xbr","","xbr",!0).info("trsp","","trsp",!0).info("tpar","","tpar",!0).info("ep","","ep",!0).info("id","","id").info("ai","","ai",!0).info("reqht","","reqht",!0).info("resht","","resht",!0);const c=0===(null===(i=Rt.newConfig)||void 0===i?void 0:i.hcs)?0:(null===(o=Rt.newConfig)||void 0===o?void 0:o.hcs)||1;1===c?null!=n&&n.ec&&n.ec>400&&a.info("rh","","rh",!0).info("rhe","","rhe",!0):2===c&&a.info("rhe","","rhe",!0).info("rh","","rh",!0);const u=a.build();if(u.data&&u.data.ai){const e=JSON.parse(JSON.stringify(u.data)),n=e.ai,i=e.id,o=zt.actionDatas.get(n);t(o)&&(o.reqMethod.forEach((t=>{t.id&&t.id===i&&(t.ne=e)})),zt.actionEnd(n,2,1))}Lt.dataArrAddFun(u)}const ae=/[@(\s]+?([\S]+):(\d+):(\d+)\)?/,ce=/([^@(\s)]+):(\d+):(\d+)/,ue=/\n/,he="MiniProgramError";function le(t){const e=Number(t);return isNaN(e)?0:e}function fe(t){if(0===t.length||t.length>2)return y("C402"),"unknown";if(1===t.length)return t[0];const e=t[0],n=t[1];return n.indexOf(e)>-1?n:e+": "+n}function de(e){let i=e;if(n(e)||e instanceof Error){let u=n(e)?e:e.stack;if(!n(c=e)||!ae.test(c))try{throw new Error(e)}catch(t){const e=t.stack.split(ue);e.splice(1,1),u=e.join("\n")}if(i=function(t){try{let e,n,i,o;const s=t.split(ue);let a=s.shift();const c=[];for(;r(a);)if(a=a.trim(),he!==a){if(ce.test(a)){e=fe(c);const t=ce.exec(a);n=t[1].replace(/^\(/,""),i=le(t[2]),o=le(t[3]);break}c.push(a),a=s.shift()}else a=s.shift();return{message:e,file:n||"<Anonymous>",line:i||0,column:o||0,duration:0,count:1,stack:b(t,2e3)}}catch(t){y("C401")}}(u),t(i)&&t(i.stack)&&(i.stack=i.stack.replace(/\n+/g,"\n")),t(i)&&t(i.message)){var o,s,a;const e=null==Ft||null===(o=Ft.page)||void 0===o?void 0:o.pvid,n=null==Ft||null===(s=Ft.page)||void 0===s?void 0:s.url;let r=(null==Ft||null===(a=Ft.page)||void 0===a?void 0:a.showTs)||Z();r=r&&1e3*r||1e3;const c=function(e){try{if(t(e)&&e.length>0)return e.split(":")[0]}catch(t){}return""}(i.message),u=new _t(i,"jserror");u.info("pvid",e).info("url",n).info("file","","n").info("message","","m").info("line",1,"l").info("column",1,"col").info("stack","","sta").info("pct",r).info("et",c).info("pt",3);const h=u.build();Lt.dataArrAddFun(h)}}var c}const pe=256;function ge(t,e){if(arguments.length<1||arguments.length>2)y("setCustomSpeedTest custom log parameter number error");else if(!ht("ip",t,"customSpeedTest",pe,!1))if(Array.isArray(e)&&e.length>0&&e.length<=1e3){const n={};n.oip=t,n.sti=e;const i=new _t(n,F);i.info("oip").info("sti");const o=i.build();Lt.dataArrAddFun(o)}else y("setCustomSpeedTest custom speedtest parameter number error")}function me(e,n){if(arguments.length<1||arguments.length>2)return void y("setCustomLog custom log parameter number error");if(ht("logInfo",e,"setCustomLog",null,!1))return;const i={},o=t(e)&&lt(e,1e4)||"",s=t(n)&&lt(n,1e4)||"";i.logInfo=o,i.logParam=s;const r=new _t(i,j);r.info("logInfo","","i").info("logParam","","p",!0);const a=r.build();Lt.dataArrAddFun(a)}function ve(e,n,i="",o="",s){if(arguments.length<1||arguments.length>5)return void y("setCustomEvent wrong number of custom event parameters");if(ht("eventId",e,"setCustomEvent",pe,!1))return;if(s&&G(s)&&JSON.stringify(s).length>7e3)return;const r={},a=lt(n,pe),c=lt(o,7e3);r.eventId=t(e)?e:"",r.eventName=a,r.eventParam=c,r.eventLabel=lt(i,256),r.info=s;const u=new _t(r,U);u.info("eventId","","i").info("eventName","","n",!0).info("eventParam","","p",!0).info("t",0).info("d",0).info("eventLabel","","l",!0).info("info","","info",!0);const h=u.build();Lt.dataArrAddFun(h)}function ye(e,n,i="",o="",s){if(arguments.length<1||arguments.length>5)return void y("setCustomEvent wrong number of custom event parameters");if(ht("eventId",e,"setCustomEvent",pe,!1))return;if(s&&G(s)&&JSON.stringify(s).length>7e3)return;const r={},a=lt(n,pe),c=lt(o,7e3);r.eventId=t(e)?e:"",r.eventName=a,r.eventParam=c,r.eventLabel=lt(i,256),r.info=s;const u=A(),h={uid:u,id:e,time:1e3*x()},l=Rt.customEventUid;let f=!1;if(l.length>0&&l.map((t=>{t.id===e&&(f=!0)})),f)return;Rt.setCustomEventUidFun(h);const d=new _t(r,U);d.info("eventId","","i").info("eventName","","n",!0).info("eventParam","","p",!0).info("t",1).info("d",0).info("ci",u).info("eventLabel","","l",!0).info("info","","info",!0);const p=d.build();Lt.dataArrAddFun(p)}function we(e,n,i="",o,s){if(arguments.length<1||arguments.length>5)return void y("setCustomEvent wrong number of custom event parameters");if(ht("eventId",e,"setCustomEvent",pe,!1))return;if(s&&G(s)&&JSON.stringify(s).length>7e3)return;const r={},a=lt(n,pe),c=lt(o,7e3);r.eventId=t(e)?e:"",r.eventName=a,r.eventParam=c,r.eventLabel=lt(i,256),r.info=s;const u=Rt.getCustomEventUidFun(e);if(!t(u))return;const h=1e3*x()-u.time,l=new _t(r,U);l.info("eventId","","i").info("eventName","","n",!0).info("eventParam","","p",!0).info("t",2).info("d",h).info("ci",u.uid).info("eventLabel","","l",!0).info("info","","info",!0);const f=l.build();Lt.dataArrAddFun(f)}function ke(e,n,i){if(arguments.length<1||arguments.length>3)return void y("setCustomMetric自定义指标参数个数错误");if(ht("metricName",e,"setCustomMetric",pe,!1))return;if(ht("metricValue",n,"setCustomMetric",null,!0))return;i&&i.length>1e4&&(i=lt(i,1e4));const o={};o.metricName=t(e)?e:"",o.metricValue=t(n)?n:"",o.metricParam=t(i)?i:"";const s=new _t(o,R);s.info("metricName","","n").info("metricValue",0,"v").info("metricParam","","p",!0);const r=s.build();Lt.dataArrAddFun(r)}function Ie(e,n){if(arguments.length<1||arguments.length>2)return void y("setCustomPageStart自定义视图参数个数错误");if(ht("name",e,"setCustomPageStart",null,!1))return;const i={},o=A();n=t(n)&&lt(n,pe)||"";const s={uid:o,name:e,time:1e3*x()},r=Rt.customPageUid;let a=!1;if(r.length>0&&r.map((t=>{t.name===e&&(a=!0)})),a)return;Rt.setCustomPageUidFun(s),i.ci=o,i.lt=999,i.m=1,i.pvid=o,i.rt=999,i.st=999,i.is=!1,i.std=[],i.n=t(e)?e:"",i.ic=!0,i.p=n||"";const c=new _t(i,yt);c.info("ci").info("lt").info("m").info("pvid").info("rt").info("st").info("is").info("std").info("n").info("ic").info("p","","p",!0);const u=c.build();Lt.dataArrAddFun(u)}function be(e,n){if(arguments.length<1||arguments.length>2)return void y("setCustomPageEnd自定义视图参数个数错误");if(ht("name",e,"setCustomPageEnd",null,!1))return;n=t(n)&&lt(n,pe)||"";const i={},o=Rt.getCustomPageUidFun(e);if(!t(o))return;const s=1e3*x()-o.time;i.ci=o.uid,i.lt=999,i.m=3,i.pvid=o.uid,i.rt=999,i.is=!1,i.std=[],i.n=t(e)?e:"",i.ic=!0,i.p=n||"",i.st=s;const r=new _t(i,yt);r.info("ci").info("lt").info("m").info("pvid").info("rt").info("is").info("std").info("n").info("ic").info("p","","p",!0).info("st","","st",!0);const a=r.build();Lt.dataArrAddFun(a)}function Se(){const t=zt.currentParentNode;let e=zt.currentActionId;t.rootId&&t.rootId!==e&&(e=t.rootId);const n=zt.actionDatas.get(e);if(!n)return;const i=n.getParentId()?n.getParentId():t.id,o=!n.getParentId();n.updateParentNode(i,"ice",!0,o),n.ice=!0;const s=1e3*x();n.updateParentNode(i,"et",s,o),n.loadTime||(n.loadTime=s-n.startTime),o?zt.actionEnd(e,2,3):zt.actionEnd(e,3,12)}function Te(t,e){if(1===e){const e=t.startTime,n=JSON.parse(JSON.stringify(t));n.ice=!1;const i=new _t(n,wt);i.info("id","","id").info("mode",1,"m").info("type",1,"t").info("sourceAction",3,"sa").info("name","","n").info("info","","i").info("viewName","","vn").info("ci","","ci").info("ic",!1,"ic").info("ice",!1,"ice").info("param","","p",!0).info("loadTime","","lt").info("is",!1,"is");const o=i.build(e);Lt.dataArrAddFun(o)}if(2==e){const e=t.startTime;if(!(t&&i(t.reqMethod)&&i(t.method)))return;{let e;zt.hasNetWork?(e=t.method.concat(t.reqMethod),e.length>200&&(e=e.slice(0,200))):e=t.method;const n=e.reduce(((t,e,n)=>(t[e.id]=n,t)),{}),i=[];e.forEach((t=>{if("root"===t.parentId)return void(i[0]=t);const o=e[n[t.parentId]];G(o)&&(o.ms=[...o.ms||[],t])})),xe(i,zt.maxDepth-1),t.me=i[0]}const n=new _t(t,wt);n.info("id","","id").info("mode",1,"m").info("type",1,"t").info("sourceAction",3,"sa").info("name","","n").info("info","","i").info("ci","","ci").info("viewName","","vn").info("ic",!1,"ic").info("ice",!1,"ice").info("param","","p",!0).info("loadTime","","lt").info("is",!1,"is").info("me","","me");const o=n.build(e);Lt.dataArrAddFun(o)}}function xe(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(delete i.parentId,delete i.id,delete i.rootId,delete i.reqState,""===i.ne&&delete i.ne,""===i.et&&(i.et=1e3*x()),i.ms&&i.ms.length&&e>0){const t=e-1;xe(i.ms,t)}else delete i.ms}}const Ce={onLoad:function(e){Ft.pageModel=1,Ft.pvidDatas[this.route]=it();!function(e){Ft.page||(Ft.page=new Kt(e,Ft.popReqs(),Ft.system));const n=Ft.page;t(n.url)||t(n.param)||(n.url=e.path,n.param=e.param,n.pvid=e.pvid),n.didLoad=!0,n.loadTs=e.t}({t:Z(),path:this.route,param:e,pvid:Ft.pvidDatas[this.route]}),ne.call(this,"page")},onShow:function(){var e;!function(t){Ft.page||(Ft.page=new Kt(t,Ft.popReqs(),Ft.system));const e=Ft.page;e.networkType=Ft.networkType||"",e.pre=Ft.route[Ft.route.length-1]||"",e.showTs=t.t,e.pvid=t.pvid,Ft.route.push(t.path),e.routes=B([],Ft.route)}({t:Z(),path:this.route,pvid:Ft.pvidDatas[this.route]}),t(null===(e=Ft.page)||void 0===e?void 0:e.didLoad)||(Ft.pageModel=2,ne.call(this,"page"))},onReady:function(){const t={t:Z()};var e;e=t,Ft.page?(Ft.page.readyTs=e.t,Ft.page.didLoad||Yt()):y("page should been created when ready")},onHide:function(){const t={t:Z()};Rt.setPageHideTime(x()),Ft.pageModel=3,ee("hideTs",t),zt.actionEnd_Hide(2,-1)},onUnload:function(){const t={t:Z()};Ft.pageModel=3,ee("unloadTs",t),zt.actionEnd_Hide(2,-1)},onPullDownRefresh:function(){},onShareAppMessage:function(){},onShareTimeline:function(){},onAddTOFavorites:function(){}},De={onLoad:function(t){},onShow:function(){var e;const n={t:Z()};var i;i=n,Ft.page?(Ft.page.showEndTs=i.t,Ft.page.didLoad||Yt()):y("page should been created when pageAfterShow"),t(null===(e=Ft.page)||void 0===e?void 0:e.didLoad)||setTimeout((()=>{Ft.pageModel=4}),300)},onReady:function(){const e={t:Z()};setTimeout((function(){!function(e){if(!Ft.page)return void y("page should been created when AfterReady");const n=1e3*e.t;if(t(Ft.page.statesInfo)&&Ft.page.statesInfo.length>0){const t=Ft.page.statesInfo.filter((t=>t.pst<n));t.length>0&&(t.sort(((t,e)=>e.pst-t.pst)),Ft.page.loadEndTs=t[0].uet>1e3*Ft.page.readyTs?t[0].uet:n)}else Ft.page.loadEndTs=n;1===Ft.pageModel&&Ft.page.didLoad&&0==Ft.page.statesInfo.length&&y("The 'setData' data cannot be collected. Maybe the user has overridden the 'setUpdatePerformanceListener' method or the user does not use 'setData'"),Ft.page.didLoad&&(Yt(),Ft.page.statesInfo=[])}(e),Ft.pageModel=4}),300)},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onShareAppMessage:function(){},onShareTimeline:function(){},onAddTOFavorites:function(){}},Ae={created:function(t){var e;e={t:null,path:null,param:null},Ft.page||(Ft.page=new Kt(e,Ft.popReqs(),Ft.system))},attached:function(){ne.call(this,"component")},ready:function(){},moved:function(){},detached:function(){},error:function(){}};function Ee(){if(Page[bt])return;Page=Ct(Page,Ce,De,Qt),Page[bt]=!0;const e=Component;e[bt]||(Component=function(n){const i=t(n)?n.methods:{};let o={...n,methods:Tt(i,Qt)};return t(o.lifetimes)?o.lifetimes=xt(o.lifetimes,Ae):o=xt(o,Ae),e.call(this,o)},Component[bt]=!0)}function Ne(){Page[bt]&&t(Page.$$origin)&&(Page=Page.$$origin)}const Me=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];var Oe=function(t){for(var e=new Array;t>0;){var n=t%2;t=Math.floor(t/2),e.push(n)}return e.reverse(),e},Pe=function(t){for(var e=0,n=0,i=t.length-1;i>=0;--i){1==t[i]&&(e+=Math.pow(2,n)),++n}return e},qe=function(t,e){for(var n=8-(t+1)+6*(t-1)-e.length;--n>=0;)e.unshift(0);for(var i=[],o=t;--o>=0;)i.push(1);i.push(0);for(var s=0,r=8-(t+1);s<r;++s)i.push(e[s]);for(var a=0;a<t-1;++a){i.push(1),i.push(0);for(var c=6;--c>=0;)i.push(e[s++])}return i};function $e(t){for(var e=[],n=[],i=0,o=t.length;i<o;++i){var s=t.charCodeAt(i),r=Oe(s);if(s<128){for(var a=8-r.length;--a>=0;)r.unshift(0);n=n.concat(r)}else s>=128&&s<=2047?n=n.concat(qe(2,r)):s>=2048&&s<=65535?n=n.concat(qe(3,r)):s>=65536&&s<=2097151?n=n.concat(qe(4,r)):s>=2097152&&s<=67108863?n=n.concat(qe(5,r)):s>=4e6&&s<=2147483647&&(n=n.concat(qe(6,r)))}var c=0;for(i=0,o=n.length;i<o;i+=6){var u=i+6-o;2==u?c=2:4==u&&(c=4);for(var h=c;--h>=0;)n.push(0);e.push(Pe(n.slice(i,i+6)))}var l="";for(i=0,o=e.length;i<o;++i)l+=Me[e[i]];for(i=0,o=c/2;i<o;++i)l+="=";return l}function Le(t,e){return`1-${String($e(gt()))}-${String($e(gt()))}-0-${String($e(Rt.appInfo.an))}-${String($e(Rt.appInfo.av))}-${e&&String($e(e))||String($e("/"))}-${String($e(t))}`}const je=new class{constructor(){this.list={},this.isOpen=!1,this.blackKey=new Set}checkIsOpen(e){t(e)&&e?this.isOpen=!0:this.isOpen=!1}getItem(e,n){const i=`${e}+${n}`;return t(e)&&this.list[i]?this.list[i]:this.setItem(e,n)}setItem(e,n){var i;let{utl:o,uwl:s,ubl:r}=(null===(i=Rt.newConfig)||void 0===i?void 0:i.irhtc)||{},a={};if(t(o)&&o.length>0){o.length>200&&(o=o.slice(0,200));for(let t=0,i=o.length-1;t<=i;t++)l(a,this.totalHead(o[t],e,n))}if(t(s)&&s.length>0){s.length>200&&(s=s.slice(0,200));for(let t=0,i=s.length-1;t<=i;t++)this.blackWhiteCheck(e,s[t],!0)&&l(a,this.blackWhiteHead(s[t],e,n))}if(t(r)&&r.length>0){r.length>200&&(r=r.slice(0,200));for(let t=0,i=r.length-1;t<=i;t++)this.blackWhiteCheck(e,r[t],!1)?l(a,this.blackWhiteHead(r[t],e,n)):this.getBlackKey(r[t]);a=this.delBlackKey(a)}Object.keys(a).length>200&&(a=function(t,e){if(!G(t))return{};var n={};return Object.keys(t).map(((i,o)=>{o<e&&(n[i]=t[i])})),n}(a,200));const c=`${e}+${n}`;return this.list[c]=a,a}totalHead(t,e,n){const i={};return l(i,this.constructData(t,e,n)),i}blackWhiteCheck(t,e,n=!0){if(e.rhr&&e.rhr.length>0)switch(e.t){case 0:if(t==e.r)return n;break;case 1:if(k(t,e.r))return n;break;case 2:if(I(t,e.r))return n;break;case 3:const i=new RegExp(e.r);if(i instanceof RegExp&&i.test(t))return n;break;case 4:if(t.indexOf(e.r)>-1)return n;break;default:return!n}return!n}blackWhiteHead(e,n,i){const o=e.rhr,s={};if(t(o)&&o.length>0)for(let t=0,e=o.length-1;t<=e;t++)l(s,this.constructData(o[t],n,i));return s}getBlackKey(e){const n=e&&e.rhr;if(t(n)&&n.length>0&&this.blackKey)for(let t=0,e=n.length-1;t<=e;t++)n[t]&&n[t].rhk&&this.blackKey.add(n[t].rhk)}delBlackKey(t={}){if(this.blackKey&&this.blackKey.size>0&&t)for(const e of this.blackKey)t&&t[e]&&delete t[e];return this.blackKey.clear(),t}checkKey(e,n,i){return!(!i||1===i)||!!t(e)&&(!(e.length>n)&&(256===n?!!/^[0-9a-zA-Z_-]{1,256}$/.test(e):512===n?!!/^[^\u4e00-\u9fa5]*$/.test(e):""!=((o=e)?String.prototype.trim?String.prototype.trim.call(o):o.toString().replace(/(^\s+)|(\s+$)/g,""):"")));var o}constructData(e,n,i){const o={};if(t(e)&&t(e.rht)&&this.checkKey(e.rhk,256)&&this.checkKey(e.rhv,512,e.rht))switch(e.rht){case 1:t(e.rhv)&&(o[e.rhk]=e.rhv);break;case 2:o[e.rhk]={fun:mt,len:16,sky:!1};break;case 3:o[e.rhk]={fun:mt,len:32,sky:!1};break;case 4:o[e.rhk]={fun:Le,len:32,sky:!0,url:n,pathname:i};break;case 5:o[e.rhk]={fun:pt,len:32,sky:!1};break;case 6:o[e.rhk]="bnro=wechat_js/"+Ft.system.version+"_request"}return o}};let Fe;const Ue={request:function(e){const n=e[0];if(n.ignore)return;const o=A(),s=zt.currentParentNode||{},r=s.rootId,a=s.id,c=zt.actionAnalyse;let u=!1,h=!1;const l=zt.actionDatas.get(r);if(r&&a&&c&&l){const t=l.ice,e=l.aboverMaxDepth,n=l.aboverMaxNumber,i=l.limitNodeNumber(a);if(u=l.thisActionAnalyse,h=!t&&!e&&!n&&!i&&u,h){const t=x();l.createReqMethod("wx.request",1,t,o,a,r),l.hasReq=!0,zt.actionEnd(r,2,1,o)}}if(n&&G(n)){const e=Z();let s,f=0;const d={id:o,reqht:{},rh:{}};n.$metric=d;const p=n.success,g=n.fail,m=n.complete,v=n.data||"";(function(){if(!Ft.page)return;Ft.page.ci,Ft.page.url})();n.success=function(){if(p){const t=A();if(r&&a&&c&&h&&l){const e=x(),n=l.createReqMethod("wx.request[success]",2,e,t,o,r);zt.currentParentNode=n}s||(s=Z());const e=Z();p.apply(this,arguments),f+=Z()-e,r&&a&&c&&h&&l&&l.reqEnd(2,t,o)}},n.fail=function(){const t=A();if(g){if(r&&a&&c&&h&&l){const e=x(),n=l.createReqMethod("wx.request[fail]",2,e,t,o,r);zt.currentParentNode=n}s||(s=Z());const e=Z();g.apply(this,arguments),f+=Z()-e,r&&a&&c&&h&&l&&l.reqEnd(2,t,o)}},n.complete=function(a){var h;const l=a&&a.profile,p=a&&a.errMsg,g=a&&a.header&&JSON.stringify(a.header)||"",y={};if(l&&l.responseStart){const t=l.responseStart-l.requestStart;y.ti=l.peerIP||"",y.tp=l.port||443,y.dt=1e3*(l.domainLookUpEnd-l.domainLookUpStart),y.ct=1e3*(l.connectEnd-l.connectStart),y.sslt=1e3*(l.SSLconnectionEnd-l.SSLconnectionStart),y.rt=1e3*(l.requestEnd-l.requestStart),y.rti=t>0?1e3*t:0,y.dti=1e3*(l.responseEnd-l.responseStart),y.ds=l.receivedBytedCount,y.rds=l.sendBytesCount,y.pt=l.protocol}if(s||(s=Z()),m){const t=Z();m.apply(this,arguments),f+=Z()-t}const w={id:o,ai:r&&c&&u?r:"",status:a.statusCode||0,method:n.method&&n.method.toUpperCase()||"GET",cb:f,ec:a.statusCode,st:e,end:s,url:n.url,rds:Y(v),rhe:g,body:v,rh:d&&d.rh?JSON.stringify(d.rh):"",...y,ds:Number(function(){if(!a)return 0;const t=a.header,e=a.data;return t&&t["content-length"]?t["content-length"]:Y(e)}()),reqht:d.reqht||{},resht:{}};t(p)&&!t(a.statusCode)&&(w.em=p,w.ec=a.statusCode||600),t(Fe)&&(w.tpar=Fe,Fe=void 0),(null==a?void 0:a.statusCode)>=400&&(w.ep="http");const k=(null===(h=Rt.newConfig)||void 0===h?void 0:h.reshtk)||[];for(const t in a.header)i(k)&&k.indexOf(t)>-1&&G(w.resht)&&Object.keys(w.resht).length<64&&(w.resht[t]=a.header[t]),"br-resp-key"===t.toLowerCase()&&(w.tid=a.header[t]),"x-br-response"===t.toLowerCase()&&(w.xbr=a.header[t]),"traceresponse"===t.toLowerCase()&&(w.trsp=a.header[t]);G(w.resht)&&Object.keys(w.resht).length<=0&&(w.resht=""),G(w.reqht)&&Object.keys(w.reqht).length<=0&&(w.reqht=""),re(0,w)}}}};function Re(e){var n;const i=e[0],o=(null===(n=Rt.newConfig)||void 0===n?void 0:n.irhtc)||{};if(!o||!G(o))return;if(Object.keys(o).length<1)return;if(i.header){if(!G(i.header))return}else i.header={};const s=function(e){if(t(e.url)&&/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(e.url)){var n=e.url.split("/")[2];n.includes(":")&&(n=n.split(":")[0]);const i=e.url.split("/").slice(3).join("/").split("?")[0];if(t(n))return je.getItem(n,i)}}(i);t(s)&&G(s)&&u(s,(function(t,e){if(t&&G(t)){let n;n=t.sky?t.fun&&t.fun(t.url,t.pathname):t.fun&&t.fun(t.len),i.header||(i.header={}),i.header[e]=n}else i.header||(i.header={}),i.header[e]=t}))}function Ke(t){var e;const n=t[0]||{};if(!G(n)||n.ignore)return;if(!n.$metric)return;const o=n.header||{};n.$metric.rh=o;const s=(null===(e=Rt.newConfig)||void 0===e?void 0:e.reqhtk)||[];if(i(s)&&s.length>0&&G(n.$metric.reqht))for(const t in o)if(s.indexOf(t)>-1){if(n.$metric.reqht&&Object.keys(n.$metric.reqht).length>=64)return;n.$metric.reqht[t]=o[t]}}function Je(t=!1){var e;const n=wx,i={};je.checkIsOpen(null===(e=Rt.newConfig)||void 0===e?void 0:e.brss);for(const t in wx)if(Ue[t]){const e=t.toString();i[e]=function(){try{var t;return Ue[e](arguments),null!==(t=Rt.newConfig)&&void 0!==t&&t.brss&&Re(arguments),Ke(arguments),n[e].apply(n,arguments)}catch(t){throw y("c401"),t}finally{_e()}}}else i[t]=n[t];wx=t?n:i}function _e(){const t=zt.currentActionId,e=zt.actionDatas.get(t);e&&e.reqMethod.length>0&&e.reqEnd(1,null)}function He(){Je(!0)}function Ve(){const e=Rt.newConfig;if(t(e)&&e.gdia){const t=e.gdia;try{wx.request({url:t,method:"GET",ignore:!0,success(t){if(200===(null==t?void 0:t.statusCode)){var e;const n=null==t||null===(e=t.data)||void 0===e?void 0:e.di;n&&Rt.setNetworkInfoIP(n),function(t){const e=new _t(t,It);e.info("t",1).info("tn","");const n=e.build();Lt.dataArrAddFun(n)}({tn:Rt.networkStateInfo})}},fail(t){}})}catch(t){}}}let We=Rt.newConfig.confCount;function ze(){var e,n,i,o,s;if(Rt.unableConfig)return;let r={v:N,di:(null==Rt?void 0:Rt.deviceInfo)||"",ai:l(null==Rt?void 0:Rt.appInfo,{ai:null==Rt?void 0:Rt.newConfig.appId})};!function(e,n){if(t(e)&&"object"==typeof e)if(!t(n)||t(e[n])&&""!==e[n])for(const n in e)t(e[n])&&""!==e[n]||delete e[n];else delete e[n]}(r.ai,"ci"),null!=Rt&&Rt.networkStateInfo.ns&&(r.nsi=null==Rt?void 0:Rt.networkStateInfo.ns);const a={};var c,u;t(null==Rt||null===(e=Rt.userInfo)||void 0===e?void 0:e.ui)&&(a.ui=(null==Rt||null===(c=Rt.userInfo)||void 0===c?void 0:c.ui)||"");t(null==Rt||null===(n=Rt.userInfo)||void 0===n?void 0:n.ei)&&(a.ei=(null==Rt||null===(u=Rt.userInfo)||void 0===u?void 0:u.ei)||"");t(a)&&a.ui&&(r.ui=a),r.nsi={ns:"WiFi"};const h={v:M,a:(null==Rt||null===(i=Rt.newConfig)||void 0===i?void 0:i.appId)||"",d:(null==Rt||null===(o=Rt.deviceInfo)||void 0===o?void 0:o.di)||""};let f=(null===(s=Rt.newConfig)||void 0===s||null===(s=s.beacon)||void 0===s?void 0:s.configAddress)||"";f="".concat(f,"?",et(h)),je.list={};const d={},p=Pt();let g="";p&&(d["BR-Encryption-Method"]=p,d["Content-Type"]="application/octet-stream",g="arraybuffer",r=Mt(r));try{wx.request({url:f,data:r,method:"POST",ignore:!0,header:d,timeout:St.timeout,responseType:g,success(e){if(200===(null==e?void 0:e.statusCode)){let n=e&&e.data;const i=e.header&&e.header["BR-Encryption-Method"]||e.header&&e.header["br-encryption-method"];qt()&&i&&(n=Ot(n,i)),function(e){if(!t(e)||1e4!=(null==e?void 0:e.rc))return Be();let n=l({},Rt.newConfig);n=l(n,e),n.newSetConfig=!0,n.setTime=at()/1e3,Rt.setNewConfig(n),function(t){const e=null==t?void 0:t.mc,n=["coollaunch","hotlaunch","mpview","network","statechange","customlog","customevent","custommetric","action"];if(e&&0!=e.length){const t=[];n.map((n=>{let i=!1;e.map((t=>{t.n===n&&(i=!0),"action"===t.n&&"action"===n&&Bt(t,e)})),i||("coollaunch"!==n&&"hotlaunch"!==n||(n="launch"),t.push(n))})),Lt.clearCacheData(t),t.forEach((t=>{switch(t){case"coollaunch":case"hotlaunch":Qe();break;case"mpview":Ne();break;case"network":He();break;case"action":zt.isStart=!1,zt.actionAnalyse=!1}}))}}(n)}(n),Rt.closeAgent(!1)}else Rt.closeAgent(!0),We>0?setTimeout((function(){We-=1,ze()}),6e4):Be()},fail(t){Be(),y(t),We>0?setTimeout((function(){We-=1,ze()}),6e4):Rt.closeConfig(!0)}})}catch(t){y("C06")}}function Be(){Qe(),Ne(),He(),Lt.stopDataCatch(),Rt.closeAgent(!0)}let Ze={};const Xe={onLaunch:function(t){Ze=B({},t);const e={time:1e3*Z(),data:Ze};setTimeout((()=>{Vt(e)}),3e3)},onShow:e=>{const n=x();!async function(t){const e=new _t(t,It);e.info("t",2);const n=e.build();if(Lt.dataArrAddFun(n),Ht){const e=Rt.appHideTime&&1e3*Rt.appHideTime;if(at()-e>3e7){const e=new _t(t,kt);e.info("t",2).info("lt",999).info("is",!1);const n=e.build();Lt.dataArrAddFun(n)}}}({data:e,time:n}),function(e){const n=Rt.appHideTime,i=ct(wx,"getStorageSync",[$]);t(e)&&t(n)&&0!==n&&(e-n)/1e3>30&&((x()/1e3-i.setTime)/3600>i.spt?(i.sp=100,ze()):i.sp>100*Math.random()?ze():Rt.closeAgent(!0))}(n)},onHide:function(){Rt.setAppHideTime(x()),async function(t){Ht=!0;const e=new _t(t,It);e.info("t",3);const n=e.build();Lt.dataArrAddFun(n,!0)}()},onError:function(t){de(t)},onUnhandleRejection:function({reason:t}){de(t)}};function Ge(){if(App=Ct(App,Xe,null,null),App[bt]=!0,e(wx.getPerformance))try{ct(wx,"getPerformance").createObserver((function(t){const e=t.getEntries();h(e,(function(t){const e=t.entryType,n=t.name;"navigation"===e&&"appLaunch"==n&&Rt.setLaunchTime(1e3*t.duration)}))})).observe({entryTypes:["navigation","render","script"]})}catch(t){y("C102")}else y("C101")}function Qe(){App[bt]&&t(App.$$origin)&&(App=App.$$origin)}const Ye={version:N,setUserId:o,customLog:o,customEvent:o,customMetric:o,setExtraInfo:o,customPageStart:o,customPageEnd:o,customEventStart:o,customEventEnd:o,customSpeedTest:o,recordCustomActionEnd:o};exports.install=function(t,e){t&&t.exec&&t.name&&Jt.install(t,e)},exports.start=function(e){var n,i,o,s;return t(e)&&function(e){const n=Rt.newConfig;t(e.configAddress)&&(n.beacon.configAddress=e.configAddress),t(e.appId)&&(n.appId=e.appId),t(e.channelId)&&Rt.setChannelId(e.channelId),t(e.version)&&Rt.setAppVersion(e.version),t(e.deviceId)&&Rt.setDeviceId(e.deviceId),e.timeout&&z(e.timeout)&&e.timeout>0&&(n.timeout=e.timeout),Rt.setNewConfig(n)}(e),function(e){const n=ct(wx,"getStorageSync",[e]),i=n.newSetConfig;t(n)&&""!==n&&i?(t(n.spt)&&t(n.setTime)&&((at()/1e3-n.setTime)/3600>n.spt?(n.sp=100,ze()):n.sp>100*Math.random()?ze():Rt.closeAgent(!0)),n.setTime=at()/1e3,Rt.setNewConfig(n)):ze()}($),t(console)&&X(console.log)&&(g=!1,i=console.log,m=i,function(t){v=t}(console.error)),t(wx)?!1===(null===(n=Rt.newConfig)||void 0===n?void 0:n.enable)?(y("C02"),Ye):(function(){var e;if(t(null==Rt||null===(e=Rt.newConfig)||void 0===e?void 0:e.mc)){var n;const t=null==Rt||null===(n=Rt.newConfig)||void 0===n?void 0:n.mc,e=["coollaunch","hotlaunch","mpview","network","action"];if(t&&0!=t.length){t.filter((t=>{if(e.includes(t.n))return t.n})).forEach((e=>{switch(e.n){case"coollaunch":case"hotlaunch":Ge();break;case"action":Bt(e,t),!1===zt.hasMpView&&Ee()}}))}}else Ge();Ee(),Je(),function(){try{wx.onNetworkStatusChange((function(t){Ve(),Rt.getNetworkInfoFun()}))}catch(t){y("C07")}}()}(),o=Ye,s={setUserId:Rt.setUserInfo.bind(Rt),setExtraInfo:Rt.setExtraInfo.bind(Rt),customLog:me,customEvent:ve,customMetric:ke,customPageStart:Ie,customPageEnd:be,customEventStart:ye,customEventEnd:we,customSpeedTest:ge,recordCustomActionEnd:Se},o&&s&&u(s,(function(t,e){c(o,e)&&(o[e]=t)})),o):(y("C01"),Ye)};
/* eslint-enable */
